---
phase: 01-interface-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/interfaces/common.interface.ts
  - components/feature-modules/entity/interface/entity.interface.ts
autonomous: true

must_haves:
  truths:
    - "No components['schemas'] imports exist in common.interface.ts"
    - "No components['schemas'] imports exist in entity.interface.ts"
    - "Custom local types (EntityTypeAttributeRow, RelationshipPickerProps, etc.) remain functional"
    - "TypeScript compiles without errors"
  artifacts:
    - path: "lib/interfaces/common.interface.ts"
      provides: "Common type re-exports from new generated models"
      contains: "from \"@/lib/types\""
    - path: "components/feature-modules/entity/interface/entity.interface.ts"
      provides: "Entity type re-exports from new generated models"
      contains: "from \"@/lib/types\""
  key_links:
    - from: "lib/interfaces/common.interface.ts"
      to: "@/lib/types"
      via: "import statement"
      pattern: "from [\"']@/lib/types[\"']"
    - from: "components/feature-modules/entity/interface/entity.interface.ts"
      to: "@/lib/types"
      via: "import statement"
      pattern: "from [\"']@/lib/types[\"']"
    - from: "components/feature-modules/entity/interface/entity.interface.ts"
      to: "lib/interfaces/common.interface.ts"
      via: "import Icon, SchemaUUID"
      pattern: "from [\"']@/lib/interfaces/common.interface[\"']"
---

<objective>
Migrate both interface files from `components["schemas"]` pattern to direct model imports from `@/lib/types`.

Purpose: Establish the new import pattern for generated OpenAPI types as foundation for service migration in Phase 2.

Output: Both interface files using `@/lib/types` imports with TypeScript compiling successfully.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-interface-migration/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate common.interface.ts</name>
  <files>lib/interfaces/common.interface.ts</files>
  <action>
Replace the entire file content with direct imports from `@/lib/types` barrel export.

Changes:
1. Remove `import { components } from "../types/types";`
2. Add single import from `@/lib/types` for: Condition, FormStructure, Icon, SchemaOptions, SchemaString, SchemaUUID
3. Re-export all types using `export type { ... }`
4. Preserve the `Schema` alias: `export type Schema = SchemaString;`
5. Define `Address` interface locally (NOT in OpenAPI spec):
   ```typescript
   export interface Address {
       street?: string;
       city?: string;
       state?: string;
       postalCode?: string;
       country?: string;
   }
   ```
6. Preserve existing comments for Schema and SchemaUUID

Final structure:
```typescript
import {
    Condition,
    FormStructure,
    Icon,
    SchemaOptions,
    SchemaString,
    SchemaUUID,
} from "@/lib/types";

export type { Condition, FormStructure, Icon, SchemaOptions, SchemaUUID };

// Basic schema type that enforces string based key identification
export type Schema = SchemaString;

// Custom local type (not in OpenAPI spec)
export interface Address {
    street?: string;
    city?: string;
    state?: string;
    postalCode?: string;
    country?: string;
}
```
  </action>
  <verify>Run `grep -c "components\[" lib/interfaces/common.interface.ts` - should return 0</verify>
  <done>common.interface.ts imports from @/lib/types, exports same types, Address defined locally</done>
</task>

<task type="auto">
  <name>Task 2: Migrate entity.interface.ts</name>
  <files>components/feature-modules/entity/interface/entity.interface.ts</files>
  <action>
Replace OpenAPI type imports with `@/lib/types` barrel import while preserving all custom local types.

Changes:
1. Keep import from common.interface.ts unchanged: `import { Icon, SchemaUUID } from "@/lib/interfaces/common.interface";`
2. Replace the complex import block from `@/lib/types/types` with single import from `@/lib/types`:
   ```typescript
   import {
       CreateEntityTypeRequest,
       DataType,
       DeleteAttributeDefinitionRequest,
       DeleteEntityResponse,
       DeleteRelationshipDefinitionRequest,
       DeleteTypeDefinitionRequest,
       Entity,
       EntityAttribute,
       EntityAttributePayload,
       EntityAttributePrimitivePayload,
       EntityAttributeRelationPayload,
       EntityAttributeRelationPayloadReference,
       EntityAttributeRequest,
       EntityLink,
       EntityPropertyType,
       EntityRelationshipCardinality,
       EntityRelationshipDefinition,
       EntityType,
       EntityTypeAttributeColumn,
       EntityTypeImpactResponse,
       SaveAttributeDefinitionRequest,
       SaveEntityRequest,
       SaveEntityResponse,
       SaveRelationshipDefinitionRequest,
       SaveTypeDefinitionRequest,
       SchemaType,
   } from "@/lib/types";
   ```
3. Re-export all OpenAPI types together:
   ```typescript
   export type {
       CreateEntityTypeRequest,
       DeleteAttributeDefinitionRequest,
       DeleteEntityResponse,
       DeleteRelationshipDefinitionRequest,
       DeleteTypeDefinitionRequest,
       Entity,
       EntityAttribute,
       EntityAttributePayload,
       EntityAttributePrimitivePayload,
       EntityAttributeRelationPayload,
       EntityAttributeRelationPayloadReference,
       EntityAttributeRequest,
       EntityLink,
       EntityRelationshipDefinition,
       EntityType,
       EntityTypeAttributeColumn,
       EntityTypeImpactResponse,
       SaveAttributeDefinitionRequest,
       SaveEntityRequest,
       SaveEntityResponse,
       SaveRelationshipDefinitionRequest,
       SaveTypeDefinitionRequest,
   };
   ```
4. Preserve ALL custom local types EXACTLY as-is:
   - `EntityTypeDefinition` interface
   - `RelationshipLimit` enum
   - `EntityRelationshipCandidate` interface
   - `EntityAttributeDefinition` interface
   - `EntityTypeAttributeRow` interface
   - `RelationshipPickerProps` interface
5. Preserve ALL type guards EXACTLY as-is:
   - `isRelationshipDefinition()`
   - `isAttributeDefinition()`
   - `isRelationshipPayload()`
6. Preserve the re-export from hooks: `export type { OverlapDetectionResult, OverlapResolution, RelationshipOverlap } from "../hooks/use-relationship-overlap-detection";`

IMPORTANT: The enums (DataType, EntityPropertyType, EntityRelationshipCardinality, SchemaType) are used by the local types but NOT re-exported - they should only be imported, not added to exports.
  </action>
  <verify>Run `grep -c "components\[" components/feature-modules/entity/interface/entity.interface.ts` - should return 0</verify>
  <done>entity.interface.ts imports from @/lib/types, all OpenAPI types re-exported, all custom types preserved</done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **No old imports remain:**
   ```bash
   grep -r "components\[\"schemas\"\]" lib/interfaces/ components/feature-modules/entity/interface/
   ```
   Should return no results.

2. **TypeScript compiles:**
   ```bash
   npm run build
   ```
   Should complete without type errors.

3. **Imports resolve correctly:**
   ```bash
   grep "from \"@/lib/types\"" lib/interfaces/common.interface.ts components/feature-modules/entity/interface/entity.interface.ts
   ```
   Should show both files importing from @/lib/types.
</verification>

<success_criteria>
1. Zero `components["schemas"]` imports in either interface file
2. Both files import from `@/lib/types` barrel export
3. All custom local types in entity.interface.ts unchanged
4. Address type defined locally in common.interface.ts
5. `npm run build` passes without TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-interface-migration/01-01-SUMMARY.md`
</output>

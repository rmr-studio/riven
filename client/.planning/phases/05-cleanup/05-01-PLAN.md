---
phase: 05-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/feature-modules/entity/**/*.ts
  - components/feature-modules/entity/**/*.tsx
  - lib/util/form/entity-instance-validation.util.ts
  - components/ui/data-table/components/cells/edit-renderers.tsx
  - components/feature-modules/entity/interface/entity.interface.ts
autonomous: true

must_haves:
  truths:
    - "No files import from entity.interface.ts"
    - "Entity domain types import from @/lib/types/entity"
    - "entity.interface.ts is deleted"
  artifacts:
    - path: "lib/types/entity/custom.ts"
      provides: "All custom entity types including overlap detection"
      contains: "OverlapDetectionResult"
    - path: "lib/types/entity/guards.ts"
      provides: "Entity type guards"
      contains: "isRelationshipDefinition"
  key_links:
    - from: "components/feature-modules/entity/**/*"
      to: "@/lib/types/entity"
      via: "import statements"
      pattern: "from [\"']@/lib/types/entity[\"']"
---

<objective>
Update all entity domain imports to use @/lib/types/entity barrel, then delete entity.interface.ts.

Purpose: Remove legacy entity interface re-export file as part of OpenAPI migration cleanup.
Output: All 45 entity files import from domain barrel; entity.interface.ts deleted.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-cleanup/05-CONTEXT.md
@.planning/phases/05-cleanup/05-RESEARCH.md

# Domain barrel (target import)
@lib/types/entity/index.ts
@lib/types/entity/custom.ts
@lib/types/entity/guards.ts

# File to delete (source of truth for what's exported)
@components/feature-modules/entity/interface/entity.interface.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update entity domain imports</name>
  <files>
    - components/feature-modules/entity/util/relationship.util.ts
    - components/feature-modules/entity/stores/entity.store.ts
    - components/feature-modules/entity/hooks/use-entity-type-table.tsx
    - components/feature-modules/entity/hooks/query/type/use-relationship-candidates.ts
    - components/feature-modules/entity/hooks/form/type/use-schema-form.ts
    - components/feature-modules/entity/hooks/form/type/use-relationship-form.ts
    - components/feature-modules/entity/hooks/form/type/use-new-type-form.ts
    - components/feature-modules/entity/context/configuration-provider.tsx
    - components/feature-modules/entity/components/ui/modals/type/delete-definition-modal.tsx
    - components/feature-modules/entity/components/ui/modals/type/attribute-form-modal.tsx
    - components/feature-modules/entity/components/types/entity-type.tsx
    - components/feature-modules/entity/components/types/entity-type-data-table.tsx
    - components/feature-modules/entity/components/tables/entity-table-utils.tsx
    - components/feature-modules/entity/components/tables/entity-draft-row.tsx
    - components/feature-modules/entity/components/tables/entity-data-table.tsx
    - components/feature-modules/entity/components/forms/type/relationship/relationship-form.tsx
    - components/feature-modules/entity/components/forms/type/relationship/relationship-candidate.tsx
    - components/feature-modules/entity/components/forms/type/configuration-form.tsx
    - components/feature-modules/entity/components/forms/type/attribute/schema-form.tsx
    - components/feature-modules/entity/components/forms/instance/entity-relationship-picker.tsx
    - components/feature-modules/entity/hooks/mutation/instance/use-delete-entity-mutation.ts
    - components/feature-modules/entity/hooks/mutation/instance/use-save-entity-mutation.ts
    - components/feature-modules/entity/hooks/mutation/type/use-delete-definition-mutation.ts
    - components/feature-modules/entity/hooks/mutation/type/use-delete-type-mutation.ts
    - components/feature-modules/entity/hooks/mutation/type/use-publish-type-mutation.ts
    - components/feature-modules/entity/hooks/mutation/type/use-save-configuration-mutation.ts
    - components/feature-modules/entity/hooks/mutation/type/use-save-definition-mutation.ts
    - components/feature-modules/entity/hooks/query/type/use-entity-types.ts
    - components/feature-modules/entity/hooks/query/use-entities.ts
    - components/feature-modules/entity/hooks/use-relationship-overlap-detection.ts
    - components/feature-modules/entity/service/entity-type.service.ts
    - components/feature-modules/entity/service/entity.service.ts
    - components/feature-modules/entity/stores/type/configuration.store.ts
    - components/feature-modules/entity/components/forms/instance/relationship/draft-entity-picker.tsx
    - components/feature-modules/entity/components/forms/type/new-entity-type-form.tsx
    - components/feature-modules/entity/components/forms/type/relationship/entity-type-multi-select.tsx
    - components/feature-modules/entity/components/forms/type/relationship/relationship-links.tsx
    - components/feature-modules/entity/components/types/entity-type-attributes.tsx
    - components/feature-modules/entity/components/types/entity-types-overview.tsx
    - components/feature-modules/entity/context/entity-provider.tsx
    - lib/util/form/entity-instance-validation.util.ts
    - components/ui/data-table/components/cells/edit-renderers.tsx
  </files>
  <action>
    For each file that imports from `@/components/feature-modules/entity/interface/entity.interface`:

    1. Identify what types/values are being imported
    2. Replace import with equivalent from `@/lib/types/entity`:
       - OpenAPI types (EntityType, EntityRelationshipDefinition, etc.) -> `@/lib/types/entity`
       - Custom types (EntityTypeDefinition, EntityTypeAttributeRow, etc.) -> `@/lib/types/entity` (from custom.ts via barrel)
       - Type guards (isRelationshipDefinition, isAttributeDefinition, etc.) -> `@/lib/types/entity` (from guards.ts via barrel)
       - Enums (RelationshipLimit) -> `@/lib/types/entity` (from custom.ts via barrel)
       - Overlap detection types (OverlapDetectionResult, etc.) -> `@/lib/types/entity` (from custom.ts via barrel)

    3. Keep `import type` for type-only imports, use regular `import` for type guards and enums (runtime values)

    Special case: `use-relationship-overlap-detection.ts` re-exports overlap types - update to export from barrel instead:
    ```typescript
    // Remove this:
    export type { OverlapDetectionResult, OverlapResolution, RelationshipOverlap } from "../hooks/use-relationship-overlap-detection";
    // These are now in @/lib/types/entity/custom.ts
    ```

    Special case: Files importing both from entity.interface AND lib/interfaces/common.interface:
    - Icon, SchemaUUID -> keep from @/lib/types/common or @/lib/types/entity (both export these)
  </action>
  <verify>
    Run: `grep -r "from.*entity\.interface" components/feature-modules/entity/ lib/util/form/ components/ui/data-table/ 2>/dev/null | grep -v ".planning" | wc -l`
    Expected: 0 matches (no files import from entity.interface)
  </verify>
  <done>All 42 files import entity types from @/lib/types/entity instead of entity.interface.ts</done>
</task>

<task type="auto">
  <name>Task 2: Delete entity.interface.ts</name>
  <files>
    - components/feature-modules/entity/interface/entity.interface.ts
  </files>
  <action>
    Delete the file: `components/feature-modules/entity/interface/entity.interface.ts`

    This file is now unused after Task 1 updated all imports.

    The file contained:
    - Re-exports from @/lib/types (now in domain barrel)
    - Custom types (already migrated to lib/types/entity/custom.ts in Phase 2)
    - Type guards (already migrated to lib/types/entity/guards.ts in Phase 2)
    - RelationshipLimit enum (already in lib/types/entity/custom.ts)
    - Overlap detection type re-exports (already in lib/types/entity/custom.ts)
  </action>
  <verify>
    Run: `ls components/feature-modules/entity/interface/entity.interface.ts 2>&1`
    Expected: "No such file or directory"

    Run: `tsc --noEmit 2>&1 | grep -c "error TS"`
    Expected: Same or fewer errors than baseline (281)
  </verify>
  <done>entity.interface.ts deleted, TypeScript still compiles with no new errors</done>
</task>

</tasks>

<verification>
1. `grep -r "from.*entity\.interface" components/ lib/ --include="*.ts" --include="*.tsx" 2>/dev/null | grep -v ".planning" | wc -l` returns 0
2. `ls components/feature-modules/entity/interface/entity.interface.ts` returns "No such file"
3. `tsc --noEmit 2>&1 | grep -c "error TS"` returns <= 281 (baseline)
</verification>

<success_criteria>
- [ ] Zero imports from entity.interface.ts in codebase
- [ ] entity.interface.ts file deleted
- [ ] TypeScript error count unchanged or decreased
- [ ] All entity domain files import from @/lib/types/entity
</success_criteria>

<output>
After completion, create `.planning/phases/05-cleanup/05-01-SUMMARY.md`
</output>

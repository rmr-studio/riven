---
phase: 04-import-updates
plan: 03
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - components/feature-modules/blocks/components/modals/entity-selector-modal.tsx
  - components/feature-modules/blocks/components/modals/type-picker-modal.tsx
  - components/feature-modules/blocks/components/panel/panel-wrapper.tsx
  - components/feature-modules/blocks/components/panel/toolbar/panel-quick-insert.tsx
  - components/feature-modules/blocks/components/render/list/content-block-list.tsx
  - components/feature-modules/blocks/components/render/reference/entity/entity-reference.tsx
  - components/feature-modules/blocks/components/sync/widget.sync.tsx
  - components/feature-modules/blocks/config/entity-block-config.ts
  - components/feature-modules/blocks/context/block-environment-provider.tsx
  - components/feature-modules/blocks/context/block-renderer-provider.tsx
  - components/feature-modules/blocks/context/layout-change-provider.tsx
  - components/feature-modules/blocks/context/tracked-environment-provider.tsx
  - components/feature-modules/blocks/hooks/use-entity-references.tsx
  - components/feature-modules/blocks/hooks/use-entity-selector.ts
  - components/feature-modules/blocks/interface/block.interface.ts
  - components/feature-modules/blocks/interface/command.interface.ts
  - components/feature-modules/blocks/interface/editor.interface.ts
  - components/feature-modules/blocks/interface/layout.interface.ts
  - components/feature-modules/blocks/util/block/factory/block.factory.ts
  - components/feature-modules/blocks/util/block/factory/instance.factory.ts
  - components/feature-modules/blocks/util/list/list-sorting.util.ts
  - components/feature-modules/blocks/util/render/render.util.ts
autonomous: true

must_haves:
  truths:
    - "No block domain files import from @/lib/types/types"
    - "All block enum references use PascalCase members"
    - "Block domain files compile without type errors from migration"
  artifacts:
    - path: "components/feature-modules/blocks/util/block/factory/block.factory.ts"
      provides: "BlockMetadataType enum usage"
      contains: "BlockMetadataType.Content"
    - path: "components/feature-modules/blocks/components/sync/widget.sync.tsx"
      provides: "NodeType enum usage"
      contains: "NodeType.Content"
  key_links:
    - from: "components/feature-modules/blocks/**/*.tsx"
      to: "@/lib/types/block"
      via: "import statements"
      pattern: "from ['\"]@/lib/types/block['\"]"
---

<objective>
Update all block domain files to import from @/lib/types/block barrel instead of @/lib/types/types

Purpose: Migrate block feature module to use domain-specific imports, completing IMP-02 requirement.

Output: 22 block files with updated imports and enum member casing
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-import-updates/04-01-SUMMARY.md
@.planning/phases/04-import-updates/04-RESEARCH.md

@lib/types/block/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update block components and config imports</name>
  <files>
    components/feature-modules/blocks/components/modals/entity-selector-modal.tsx
    components/feature-modules/blocks/components/modals/type-picker-modal.tsx
    components/feature-modules/blocks/components/panel/panel-wrapper.tsx
    components/feature-modules/blocks/components/panel/toolbar/panel-quick-insert.tsx
    components/feature-modules/blocks/components/render/list/content-block-list.tsx
    components/feature-modules/blocks/components/render/reference/entity/entity-reference.tsx
    components/feature-modules/blocks/components/sync/widget.sync.tsx
    components/feature-modules/blocks/config/entity-block-config.ts
  </files>
  <action>
For each file, update imports from `@/lib/types/types` to `@/lib/types/block`.

**Import path changes:**
```typescript
// BEFORE
import { BlockMetadataType, NodeType, EntityType, ... } from "@/lib/types/types";

// AFTER
import { BlockMetadataType, NodeType, ... } from "@/lib/types/block";
import type { EntityType } from "@/lib/types/entity";  // EntityType is an entity domain model
```

**Special case:** `EntityType` is a model type from entity domain, not block domain. Import it from `@/lib/types/entity` or `@/lib/types/models` as appropriate.

**Enum member casing changes:**
- `BlockMetadataType.CONTENT` -> `BlockMetadataType.Content`
- `BlockMetadataType.ENTITY_REFERENCE` -> `BlockMetadataType.EntityReference`
- `BlockMetadataType.BLOCK_REFERENCE` -> `BlockMetadataType.BlockReference`
- `NodeType.CONTENT` -> `NodeType.Content`
- `NodeType.REFERENCE` -> `NodeType.Reference`
- `NodeType.ERROR` -> `NodeType.Error`
- `RenderType.CONTENT` -> `RenderType.Content`
- `RenderType.GRID` -> `RenderType.Grid`
- `BlockListOrderingMode.MANUAL` -> `BlockListOrderingMode.Manual`
- `ListFilterLogicType.AND` -> `ListFilterLogicType.And`
- `ListFilterLogicType.OR` -> `ListFilterLogicType.Or`
  </action>
  <verify>
```bash
grep -r "from ['\"]@/lib/types/types['\"]" components/feature-modules/blocks/components/ components/feature-modules/blocks/config/ | wc -l
# Should be 0
```
  </verify>
  <done>Block components and config import from @/lib/types/block with PascalCase enum members</done>
</task>

<task type="auto">
  <name>Task 2: Update block contexts, hooks, interfaces, and utils</name>
  <files>
    components/feature-modules/blocks/context/block-environment-provider.tsx
    components/feature-modules/blocks/context/block-renderer-provider.tsx
    components/feature-modules/blocks/context/layout-change-provider.tsx
    components/feature-modules/blocks/context/tracked-environment-provider.tsx
    components/feature-modules/blocks/hooks/use-entity-references.tsx
    components/feature-modules/blocks/hooks/use-entity-selector.ts
    components/feature-modules/blocks/interface/block.interface.ts
    components/feature-modules/blocks/interface/command.interface.ts
    components/feature-modules/blocks/interface/editor.interface.ts
    components/feature-modules/blocks/interface/layout.interface.ts
    components/feature-modules/blocks/util/block/factory/block.factory.ts
    components/feature-modules/blocks/util/block/factory/instance.factory.ts
    components/feature-modules/blocks/util/list/list-sorting.util.ts
    components/feature-modules/blocks/util/render/render.util.ts
  </files>
  <action>
For each file, apply same import path and enum casing changes as Task 1.

**Interface files special handling:**
Per CONTEXT.md: "Consumers import from barrels, leaving interface files for Phase 5 cleanup."

For interface files (block.interface.ts, command.interface.ts, editor.interface.ts, layout.interface.ts):
- These files use `components` and `operations` from types.ts for type extraction
- Leave `operations` imports as-is (they extract from openapi-typescript schema)
- Update enum imports to come from @/lib/types/block or @/lib/types/models
- Update model type imports (EntityType, BlockType, etc.) to domain barrels

**Additional enum member casing for these files:**
- `BlockOperationType.ADD` -> `BlockOperationType.Add`
- `BlockOperationType.REMOVE` -> `BlockOperationType.Remove`
- `BlockOperationType.MOVE` -> `BlockOperationType.Move`
- `BlockOperationType.UPDATE` -> `BlockOperationType.Update`
- `BlockOperationType.REORDER` -> `BlockOperationType.Reorder`
- `BlockReferenceFetchPolicy.LAZY` -> `BlockReferenceFetchPolicy.Lazy`
- `BlockReferenceFetchPolicy.EAGER` -> `BlockReferenceFetchPolicy.Eager`
- `BlockValidationScope.SOFT` -> `BlockValidationScope.Soft`
- `BlockValidationScope.STRICT` -> `BlockValidationScope.Strict`
- `Presentation.ENTITY` -> `Presentation.Entity`
- `ReferenceType.ENTITY` -> `ReferenceType.Entity`
- `ReferenceType.BLOCK` -> `ReferenceType.Block`
- `SortDir.ASC` -> `SortDir.Asc`
- `SortDir.DESC` -> `SortDir.Desc`
  </action>
  <verify>
```bash
# Check for remaining legacy imports (excluding operations which is acceptable)
grep -r "from ['\"]@/lib/types/types['\"]" components/feature-modules/blocks/ | grep -v "operations" | wc -l
# Should be 0

npx tsc --noEmit 2>&1 | grep -c "blocks/" || echo "0 errors"
```
  </verify>
  <done>All block domain files import from @/lib/types/block with PascalCase enum members</done>
</task>

</tasks>

<verification>
```bash
# Verify no legacy imports remain (except operations in interface files)
grep -r "from ['\"]@/lib/types/types['\"]" components/feature-modules/blocks/
# Should only show interface files importing 'operations' for type extraction

# Verify no SCREAMING_CASE enum members remain
grep -rE "\.(CONTENT|ENTITY_REFERENCE|BLOCK_REFERENCE|REFERENCE|ERROR|ADD|REMOVE|MOVE|UPDATE)" components/feature-modules/blocks/ --include="*.ts" --include="*.tsx" | head -20
# Should return empty (or only string literals)

# Type check
npx tsc --noEmit
```
</verification>

<success_criteria>
- Block domain files import from @/lib/types/block (except operations in interface files)
- All enum member references use PascalCase
- TypeScript compilation passes
- IMP-02 requirement satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/04-import-updates/04-03-SUMMARY.md`
</output>
